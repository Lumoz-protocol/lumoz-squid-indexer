module.exports = class Data1733473538875 {
    name = 'Data1733473538875'

    async up(db) {
        await db.query(`CREATE TABLE "resource" ("id" character varying NOT NULL, "type" text NOT NULL, CONSTRAINT "PK_e2894a5867e06ae2e8889f1173f" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "token" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "decimals" integer NOT NULL, "token_address" text NOT NULL, "token_symbol" text NOT NULL, "resource_id" character varying, "domain_id" character varying, CONSTRAINT "PK_82fae97f905930df5d62a702fc9" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_435ef0917a04e91698042dff2b" ON "token" ("resource_id") `)
        await db.query(`CREATE INDEX "IDX_3d565341b16e9c03d63e05eac8" ON "token" ("domain_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_ada3dfc11e70168668345b2951" ON "token" ("token_address", "domain_id") `)
        await db.query(`CREATE TABLE "domain" ("id" character varying NOT NULL, "name" text NOT NULL, CONSTRAINT "PK_27e3ec3ea0ae02c8c5bceab3ba9" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "fee" ("id" character varying NOT NULL, "amount" text NOT NULL, "deposit_id" character varying, "domain_id" character varying, "token_id" uuid, CONSTRAINT "PK_ee7e51cc563615bc60c2b234635" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_a81285659ab5f86b08e7776700" ON "fee" ("deposit_id") `)
        await db.query(`CREATE INDEX "IDX_dab28f6cfe8ff03f1da38f0d79" ON "fee" ("domain_id") `)
        await db.query(`CREATE INDEX "IDX_bde4aa972635af552acf115242" ON "fee" ("token_id") `)
        await db.query(`CREATE TABLE "account" ("id" character varying NOT NULL, "address_status" text, CONSTRAINT "PK_54115ee388cdb6d86bb4bf5b2ea" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "deposit" ("id" character varying NOT NULL, "type" text NOT NULL, "tx_hash" text NOT NULL, "block_number" text NOT NULL, "deposit_data" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE, "handler_response" text NOT NULL, "fee_id" character varying, "account_id" character varying, "deposit_nonce" text, "resource_id" character varying, "from_domain_id" character varying, "to_domain_id" character varying, "destination" text, "amount" text NOT NULL, CONSTRAINT "REL_f59479ebb45249bbdd5c12f75e" UNIQUE ("fee_id"), CONSTRAINT "PK_6654b4be449dadfd9d03a324b61" PRIMARY KEY ("id"))`)
        await db.query(`CREATE UNIQUE INDEX "IDX_f59479ebb45249bbdd5c12f75e" ON "deposit" ("fee_id") `)
        await db.query(`CREATE INDEX "IDX_9ced91570695137ec1d60c1a61" ON "deposit" ("account_id") `)
        await db.query(`CREATE INDEX "IDX_268f596937633ed18ea80fb27f" ON "deposit" ("resource_id") `)
        await db.query(`CREATE INDEX "IDX_5ecb563af64a40be22ccd47f55" ON "deposit" ("from_domain_id") `)
        await db.query(`CREATE INDEX "IDX_1f6c1a9d4ac6d8900adab3d546" ON "deposit" ("to_domain_id") `)
        await db.query(`CREATE TABLE "execution" ("id" character varying NOT NULL, "tx_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE, "block_number" text NOT NULL, "message" text, CONSTRAINT "PK_cc6684fedf29ec4c86db8448a2b" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "transfer" ("id" character varying NOT NULL, "status" character varying(8) NOT NULL, "deposit_id" character varying, "execution_id" character varying, CONSTRAINT "REL_0832a6ad200eac838da26a9961" UNIQUE ("deposit_id"), CONSTRAINT "REL_4b62ae14edfb27605cd911db59" UNIQUE ("execution_id"), CONSTRAINT "PK_fd9ddbdd49a17afcbe014401295" PRIMARY KEY ("id"))`)
        await db.query(`CREATE UNIQUE INDEX "IDX_0832a6ad200eac838da26a9961" ON "transfer" ("deposit_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_4b62ae14edfb27605cd911db59" ON "transfer" ("execution_id") `)
        await db.query(`ALTER TABLE "token" ADD CONSTRAINT "FK_435ef0917a04e91698042dff2bc" FOREIGN KEY ("resource_id") REFERENCES "resource"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "token" ADD CONSTRAINT "FK_3d565341b16e9c03d63e05eac83" FOREIGN KEY ("domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "fee" ADD CONSTRAINT "FK_a81285659ab5f86b08e77767007" FOREIGN KEY ("deposit_id") REFERENCES "deposit"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "fee" ADD CONSTRAINT "FK_dab28f6cfe8ff03f1da38f0d793" FOREIGN KEY ("domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "fee" ADD CONSTRAINT "FK_bde4aa972635af552acf1152420" FOREIGN KEY ("token_id") REFERENCES "token"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "deposit" ADD CONSTRAINT "FK_f59479ebb45249bbdd5c12f75ee" FOREIGN KEY ("fee_id") REFERENCES "fee"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "deposit" ADD CONSTRAINT "FK_9ced91570695137ec1d60c1a61b" FOREIGN KEY ("account_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "deposit" ADD CONSTRAINT "FK_268f596937633ed18ea80fb27f8" FOREIGN KEY ("resource_id") REFERENCES "resource"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "deposit" ADD CONSTRAINT "FK_5ecb563af64a40be22ccd47f554" FOREIGN KEY ("from_domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "deposit" ADD CONSTRAINT "FK_1f6c1a9d4ac6d8900adab3d546c" FOREIGN KEY ("to_domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer" ADD CONSTRAINT "FK_0832a6ad200eac838da26a99615" FOREIGN KEY ("deposit_id") REFERENCES "deposit"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer" ADD CONSTRAINT "FK_4b62ae14edfb27605cd911db591" FOREIGN KEY ("execution_id") REFERENCES "execution"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "resource"`)
        await db.query(`DROP TABLE "token"`)
        await db.query(`DROP INDEX "public"."IDX_435ef0917a04e91698042dff2b"`)
        await db.query(`DROP INDEX "public"."IDX_3d565341b16e9c03d63e05eac8"`)
        await db.query(`DROP INDEX "public"."IDX_ada3dfc11e70168668345b2951"`)
        await db.query(`DROP TABLE "domain"`)
        await db.query(`DROP TABLE "fee"`)
        await db.query(`DROP INDEX "public"."IDX_a81285659ab5f86b08e7776700"`)
        await db.query(`DROP INDEX "public"."IDX_dab28f6cfe8ff03f1da38f0d79"`)
        await db.query(`DROP INDEX "public"."IDX_bde4aa972635af552acf115242"`)
        await db.query(`DROP TABLE "account"`)
        await db.query(`DROP TABLE "deposit"`)
        await db.query(`DROP INDEX "public"."IDX_f59479ebb45249bbdd5c12f75e"`)
        await db.query(`DROP INDEX "public"."IDX_9ced91570695137ec1d60c1a61"`)
        await db.query(`DROP INDEX "public"."IDX_268f596937633ed18ea80fb27f"`)
        await db.query(`DROP INDEX "public"."IDX_5ecb563af64a40be22ccd47f55"`)
        await db.query(`DROP INDEX "public"."IDX_1f6c1a9d4ac6d8900adab3d546"`)
        await db.query(`DROP TABLE "execution"`)
        await db.query(`DROP TABLE "transfer"`)
        await db.query(`DROP INDEX "public"."IDX_0832a6ad200eac838da26a9961"`)
        await db.query(`DROP INDEX "public"."IDX_4b62ae14edfb27605cd911db59"`)
        await db.query(`ALTER TABLE "token" DROP CONSTRAINT "FK_435ef0917a04e91698042dff2bc"`)
        await db.query(`ALTER TABLE "token" DROP CONSTRAINT "FK_3d565341b16e9c03d63e05eac83"`)
        await db.query(`ALTER TABLE "fee" DROP CONSTRAINT "FK_a81285659ab5f86b08e77767007"`)
        await db.query(`ALTER TABLE "fee" DROP CONSTRAINT "FK_dab28f6cfe8ff03f1da38f0d793"`)
        await db.query(`ALTER TABLE "fee" DROP CONSTRAINT "FK_bde4aa972635af552acf1152420"`)
        await db.query(`ALTER TABLE "deposit" DROP CONSTRAINT "FK_f59479ebb45249bbdd5c12f75ee"`)
        await db.query(`ALTER TABLE "deposit" DROP CONSTRAINT "FK_9ced91570695137ec1d60c1a61b"`)
        await db.query(`ALTER TABLE "deposit" DROP CONSTRAINT "FK_268f596937633ed18ea80fb27f8"`)
        await db.query(`ALTER TABLE "deposit" DROP CONSTRAINT "FK_5ecb563af64a40be22ccd47f554"`)
        await db.query(`ALTER TABLE "deposit" DROP CONSTRAINT "FK_1f6c1a9d4ac6d8900adab3d546c"`)
        await db.query(`ALTER TABLE "transfer" DROP CONSTRAINT "FK_0832a6ad200eac838da26a99615"`)
        await db.query(`ALTER TABLE "transfer" DROP CONSTRAINT "FK_4b62ae14edfb27605cd911db591"`)
    }
}
